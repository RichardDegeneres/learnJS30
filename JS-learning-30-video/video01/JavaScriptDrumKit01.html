<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>JSDrumKit-exe</title>
        <link href="CSS/reset.css" type="text/css" rel="stylesheet" />
        <link href="CSS/stylesJSDrumKit01.css" type="text/css" rel="stylesheet" />
    </head>
    <body>
        <div class="keys">
            <div class="key" data-key="65">
                <kbd>A</kbd>
                <p class="txt">CLAP</p>
            </div>
            <div class="key" data-key="83">
                <kbd>S</kbd>
                <p class="txt">HIHAT</p>
            </div>
            <div class="key" data-key="68">
                <kbd>D</kbd>
                <p class="txt">KICK</p>
            </div>
            <div class="key" data-key="70">
                <kbd>F</kbd>
                <p class="txt">OPENHAT</p>
            </div>
            <div class="key" data-key="71">
                <kbd>G</kbd>
                <p class="txt">BOOM</p>
            </div>
            <div class="key" data-key="72"> 
                <kbd>H</kbd>
                <p class="txt">RIDE</p>
            </div>
            <div class="key" data-key="74">
                <kbd>J</kbd>
                <p class="txt">SNARE</p>
            </div>
            <div class="key" data-key="75">
                <kbd>K</kbd>
                <p class="txt">TOM</p>
            </div>
            <div class="key" data-key="76">
                <kbd>L</kbd>
                <p class="txt">TINK</p>
            </div>
        </div>    

        <audio data-key= "65" src="sounds/clap.wav"></audio>
        <audio data-key= "83" src="sounds/hihat.wav"></audio>
        <audio data-key= "68" src="sounds/kick.wav"></audio>
        <audio data-key= "70" src="sounds/openhat.wav"></audio>
        <audio data-key= "71" src="sounds/boom.wav"></audio>
        <audio data-key= "72" src="sounds/ride.wav"></audio>
        <audio data-key= "74" src="sounds/snare.wav"></audio>
        <audio data-key= "75" src="sounds/tom.wav"></audio>
        <audio data-key= "76" src="sounds/tink.wav"></audio>
        
        <script type="text/javascript">

    
        function playSound(e){          
            const audio = document.querySelector(`audio[data-key="${e.keyCode}"]`);//筛选对象
            const key = document.querySelector(`.key[data-key="${e.keyCode}"]`);
            if(!audio) return;
            key.classList.add('playing');//添加播放样式,对象选择有问题导致出错无反应
            audio.currentTime = 0;//实时播放
            audio.play();//将声音播放
            
        }

        function removeTransition(e){
            if(e.propertyName !== "transform") return;
            //console.log(e.propertyName);//只有添加了playing的标签key才有transform属性
            this.classList.remove('playing');//es6代码实现移除css样式的特点
        }
        
        window.addEventListener('keydown', playSound);//监听输入键值
       
        const keys =document.querySelectorAll('.key');
        keys.forEach(key=>key.addEventListener('transitionend',removeTransition));
        
/*
            window.addEventListener('keydown', function(e){
                const audio = document.querySelector(`audio[data-key="${e.keyCode}"]`);
                const key = document.querySelector(`.key[data-key="${e.keyCode}"]`);
                if(!audio) return;
                audio.currentTime = 0;//实时播放
                audio.play();//将声音播放


                console.log(key);
            });
*/        
        </script>

    </body>
</html>